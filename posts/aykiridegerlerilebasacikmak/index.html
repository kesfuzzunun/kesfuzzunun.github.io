<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Aykırı Değerlerle Başa Çıkmak" /><meta name="author" content="Mehmet Ali Akkın" /><meta property="og:locale" content="en" /><meta name="description" content="Keşfüzzunun Projesi hakkında bilgiler ve gelişmeler" /><meta property="og:description" content="Keşfüzzunun Projesi hakkında bilgiler ve gelişmeler" /><link rel="canonical" href="/posts/aykiridegerlerilebasacikmak/" /><meta property="og:url" content="/posts/aykiridegerlerilebasacikmak/" /><meta property="og:site_name" content="Keşfüzzunun" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-09T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Aykırı Değerlerle Başa Çıkmak" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Mehmet Ali Akkın" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Mehmet Ali Akkın"},"dateModified":"2022-05-09T00:00:00+00:00","datePublished":"2022-05-09T00:00:00+00:00","description":"Keşfüzzunun Projesi hakkında bilgiler ve gelişmeler","headline":"Aykırı Değerlerle Başa Çıkmak","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/aykiridegerlerilebasacikmak/"},"url":"/posts/aykiridegerlerilebasacikmak/"}</script><title>Aykırı Değerlerle Başa Çıkmak | Keşfüzzunun</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Keşfüzzunun"><meta name="application-name" content="Keşfüzzunun"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> </a></div><div class="site-title mt-3"> <a href="/">Keşfüzzunun</a></div><div class="site-subtitle font-italic">Proje Sayfası</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/kesfuzzunun" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Aykırı Değerlerle Başa Çıkmak</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Aykırı Değerlerle Başa Çıkmak</h1><div class="post-meta text-muted"><div> By <em> <a href="https://medium.com/@maliakkin">Mehmet Ali Akkın</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652054400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-09 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="940 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="https://miro.medium.com/max/1400/1*xzpXzg2TB9uoXRUdIXBe6Q.jpeg" alt="image.png" data-proofer-ignore></p><p>Bu yazımızda veri ön işlemenin önemli adımlarından biri olan aykırı değer sorununu python uygulaması ile nasıl çözebileceğimizi ele alacağız.</p><h3 id="verileriniz-kötüyse-makine-öğrenimi-araçlarınız-işe-yaramaz-harvard-business-review"><span class="mr-2">“Verileriniz kötüyse, makine öğrenimi araçlarınız işe yaramaz.” (harvard business review)</span><a href="#verileriniz-kötüyse-makine-öğrenimi-araçlarınız-işe-yaramaz-harvard-business-review" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Genel olarak, makine öğrenmesi öğrenenler için 🙂, veri ön işlemenin sonunda verilerinizi modele fit etmek en heyecan verici kısımdır. Ne yazık ki makine öğrenmesi çalışmalarının büyük bir kısmı verilerin model için hazırlanmasından oluşur. Aykırı değerlerle uğraşmak, özellik mühendisliğinin ve veri ön işlemenin önemli bir parçasıdır. Bunun için aykırı değerlerle nasıl başa çıkabileceğimize bir göz atalım.</p><h1 id="aykırı-değerler-ve-yaklaşım-türleri">Aykırı Değerler ve Yaklaşım Türleri</h1><p>Aykırı değerler, veri kümesinin genel yapısını bozan ve doğrusal modellerde sorunlara neden olan verilerdir. Aykırı değerlerle başa çıkmak için farklı yöntemler denenebilir.</p><h1 id="sektör-bilgisi">Sektör Bilgisi</h1><p>Bunlardan biri, sektör bilginize dayanarak, uğraştığınız sektöre ait bir veri setinde sahip olduğunuz verilerin eşik değerlerini belirlemektir. (Kiralık evler verisi ile uğraştığınızda bir evin metrekaresi için aykırı bir değer belirlemek gibi düşünebiliriz.)</p><h1 id="standart-sapma">Standart sapma</h1><p>Veya verilerinizi gözden geçirdikten sonra standart sapmanızı kontrol eder ve ortalamadan belirli (örn. 2.5 standart sapma) standart sapma uzakta olan değerleri aykırı değerler olarak tanımlarsınız.</p><h1 id="z-skoru">Z-Skoru</h1><p>Z-puanı yönteminde ortalama 0 kabul edilir, ortalamadan bir standart sapma 1 z puanıdır. Bir eşik z-skor değeri belirlenir ve bu değer baz alınarak aykırı değerler hesaplanır.</p><h1 id="boxplot">Boxplot</h1><p><img data-src="https://miro.medium.com/max/1400/1*i9b6wYv35jlr0DrcgZ3ZSQ.png" alt="image.png" data-proofer-ignore></p><p>Boxplot en çok tercih edilen yöntemdir. Hesapladığımız çeyrekler açıklığı (iqr) ile alt ve üst limitlerimizi belirliyoruz.</p><p>üst limit= q3+1.5x iqr</p><p>alt limit = q1–1.5 x iqr</p><p>IQR = q3 — q1</p><h1 id="kutu-grafiği-yönteminin-uygulanması">Kutu Grafiği Yönteminin Uygulanması</h1><p>Gerekli import işlemlerini yaptıktan sonra veri ön işlemeye başlayabiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
</pre></table></code></div></div><p>İlk olarak, çeyrekler açıklığı üzerinden üst ve alt limitleri belirleyelim.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">q1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">q3</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">)</span>
<span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
<span class="n">up</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
<span class="n">low</span> <span class="o">=</span> <span class="n">q1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>

<span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">)]</span>
</pre></table></code></div></div><p>Aykırı değer var mı?</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">)].</span><span class="nb">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">),</span>

<span class="c1"># "axis=None" olmasının nedeni, tüm verileri satır veya sütunlardan bağımsız olarak gözlemlemek istememizdir.
# Daha sonra bu süreci işlevselleştirebilir ve ileride kullanmak üzere kaydedebiliriz.
</span></pre></table></code></div></div><p>Daha sonra bu süreci fonksiyonlaştırabilir ve ileride kullanmak üzere kaydedebiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">outlier_thresholds</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">col_name</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">q3</span><span class="o">=</span><span class="mf">0.75</span><span class="p">):</span>
    <span class="n">quartile1</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col_name</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="n">q1</span><span class="p">)</span>
    <span class="n">quartile3</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col_name</span><span class="p">].</span><span class="n">quantile</span><span class="p">(</span><span class="n">q3</span><span class="p">)</span>
    <span class="n">interquantile_range</span> <span class="o">=</span> <span class="n">quartile3</span> <span class="o">-</span> <span class="n">quartile1</span>
    <span class="n">up_limit</span> <span class="o">=</span> <span class="n">quartile3</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">interquantile_range</span>
    <span class="n">low_limit</span> <span class="o">=</span> <span class="n">quartile1</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">interquantile_range</span>
    <span class="k">return</span> <span class="n">low_limit</span><span class="p">,</span> <span class="n">up_limit</span>
<span class="n">outlier_thresholds</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">)</span>
</pre></table></code></div></div><p>Şimdiye kadar eşik değerleri belirledik, aykırı değerlere ulaştık ve aykırı değer olup olmadığını kontrol ettik.</p><p>Burada başka bir fonksiyon oluşturarak aykırı değer olup olmadığını hızlıca kontrol edebiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">check_outlier</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>
    <span class="n">low_limit</span><span class="p">,</span> <span class="n">up_limit</span> <span class="o">=</span> <span class="n">outlier_thresholds</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">col_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dataframe</span><span class="p">[(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up_limit</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">dataframe</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low_limit</span><span class="p">)].</span><span class="nb">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="n">check_outlier</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">)</span>
</pre></table></code></div></div><p>Aykırı değerlere veya indeks bilgilerine ulaşmak istediğimizde aşağıdaki seçim işlemlerini kullanabiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">)].</span><span class="n">head</span><span class="p">()</span>


<span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">)].</span><span class="n">index</span>
</pre></table></code></div></div><p>Peki seçtiğimiz veri sayısal değilse bunu fonksiyona nasıl belirtebiliriz? Veya veri setindeki kategorik ve sayısal değişkenleri, hatta kategorik ve kategorik görünümlü sayısal değerleri sayısal bir görünümle belirten bir fonksiyonumuz olsaydı? Bunun için aşağıdaki adımları takip edebiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">grab_col_names</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">cat_th</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">car_th</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>

<span class="c1">#Not: Sayısal görünüme sahip kategorik değişkenler de kategorik değişkenlere dahildir.
</span>
    <span class="c1"># cat_cols, cat_but_car
</span>    <span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s">"O"</span><span class="p">]</span>
    <span class="n">num_but_cat</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">cat_th</span> <span class="ow">and</span>
                   <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s">"O"</span><span class="p">]</span>
    <span class="n">cat_but_car</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">nunique</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">car_th</span> <span class="ow">and</span>
                   <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">dtypes</span> <span class="o">==</span> <span class="s">"O"</span><span class="p">]</span>
    <span class="n">cat_cols</span> <span class="o">=</span> <span class="n">cat_cols</span> <span class="o">+</span> <span class="n">num_but_cat</span>
    <span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cat_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cat_but_car</span><span class="p">]</span>

    <span class="c1"># num_cols
</span>    <span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="p">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">dtypes</span> <span class="o">!=</span> <span class="s">"O"</span><span class="p">]</span>
    <span class="n">num_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">num_but_cat</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">cat_cols</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">cat_but_car</span>
</pre></table></code></div></div><p>Gördüğünüz gibi bunu bize her zaman işimize yarayabilecek kategorik, sayısal ve kategorik görünümlü ana sütunları gösteren bir fonksiyon olarak kullanabiliriz. Aşağıdaki kod ile veri setimizdeki sütun isimlerini kaydedip görüntüleyebiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">cat_cols</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">cat_but_car</span> <span class="o">=</span> <span class="n">grab_col_names</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></table></code></div></div><p>Daha önce belirtildiği gibi, boxplot yöntemi yalnızca sayısal verilerde aykırı değerleri bulmamıza izin verdi. Artık “grab_col_names” fonksiyonu yardımıyla bulduğumuz sayısal verilerimizin aykırı değerlerini bulabiliriz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">outlier_thresholds</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">)</span>
</pre></table></code></div></div><h1 id="aykırı-değerler-sorununu-çözme">Aykırı Değerler Sorununu Çözme</h1><p>Aykırı değerler sorununun mevcut duruma göre farklı çözümleri vardır. Bu durumda aykırı değerlerden kurtulmak için onları silebilir, yok sayabilir veya eşikler değerler ile yeniden atayabiliriz.</p><h1 id="silme">Silme</h1><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">outlier_thresholds</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">)</span>
<span class="n">check_outlier</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">))]</span>
<span class="c1">#Yukarıdaki seçim işleminde kullandığımız “~” işareti sayesinde aykırı olmayan değerleri seçiyoruz.
</span></pre></table></code></div></div><h1 id="eşiklerle-değerler-ile-yeniden-atama">Eşiklerle Değerler ile Yeniden Atama</h1><p>Bazı senaryolarda, aykırı değerlere sahip diğer satır verileri önemli olduğunda, bunları silmek yerine baskılamamız gerekebilir. Bu gibi durumlarda, aykırı değerleri eşiklerle değiştiririz.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">outlier_thresholds</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">)</span>
<span class="n">check_outlier</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s">"Age"</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">up</span><span class="p">),</span> <span class="s">"Age"</span><span class="p">]</span> <span class="o">=</span> <span class="n">up_limit</span> <span class="c1">#upper treshold
</span>
<span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s">"Age"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">low</span><span class="p">),</span> <span class="s">"Age"</span><span class="p">]</span> <span class="o">=</span> <span class="n">low_limit</span> <span class="c1">#lower treshold
</span></pre></table></code></div></div><h1 id="yoksaymak">Yoksaymak</h1><p>Ancak ağaç yapılarını ele aldığımızda, modelimiz için bir sorun teşkil etmedikleri için aykırı değerleri görmezden geliyoruz. Özellikle ağaç modelleri model eğitme süresinde uzama oluşturabilmesi dışında aykırı değerlere karşı duyarsızdır.</p><p>Bu yazıda, veri ön işlemenin önemli bir parçası olan aykırı değerlerle başa çıkma konusunu uygulamalı bir şekilde incelemeye çalıştım. Umarım faydalı olmuştur.</p><p>Sormak istediğiniz sorular veya eklemek istediğiniz eleştirileriniz varsa yazmaktan çekinmeyin… 🤙🏻</p><h1 id="kaynaklar">Kaynaklar</h1><p>“Box Plot Diagram to Identify Outliers.” n.d. Accessed April 14, 2022. https://www.whatissixsigma.net/box-plot-diagram-to-identify-outliers/.</p><p>“I Have An Outlier!” n.d. Accessed April 15, 2022. https://www.ctspedia.org/do/view/CTSpedia/OutLier.</p><p>“Identifying Outliers.” n.d. Accessed April 15, 2022. https://help.highbond.com/helpdocs/analytics/15/en-us/Content/analytics/analyzing_data/identifying_outliers.htm.</p><p>“If Your Data Is Bad Your Machine Learning Tools Are Useless.” Accessed April 14, 2022. https://hbr.org/2018/04/if-your-data-is-bad-your-machine-learning-tools-are-useless</p><p>Resim 1.: https://lord-of-the-art.livejournal.com/461918.html Resim 2.: https://storage.googleapis.com/publiclab-production/public/system/images/photos/000/032/980/original/Screen_Shot_2019-06-18_at_10.27.45_AM.png</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ml/'>ML</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Aykırı Değerlerle Başa Çıkmak - Keşfüzzunun&amp;url=/posts/aykiridegerlerilebasacikmak/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Aykırı Değerlerle Başa Çıkmak - Keşfüzzunun&amp;u=/posts/aykiridegerlerilebasacikmak/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=/posts/aykiridegerlerilebasacikmak/&amp;text=Aykırı Değerlerle Başa Çıkmak - Keşfüzzunun" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">kesfuzzunun</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
